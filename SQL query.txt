SELECT plus.item_id,
       plus.plus_tag,
       i.NAME,
       i.restaurant_id,
       attr.rest_name,
       attr.city,
       attr.city_id,
       attr.area,
       availability
FROM   (SELECT restaurant_id,
               ( Sum(actual_open_duration) / Sum(ideal_open_duration) ) > 0.75
               AS
                      availability
        FROM   restaurant_serviceability_slot
        WHERE  dt BETWEEN CURRENT_DATE - 6 AND CURRENT_DATE
        GROUP  BY 1) av
       RIGHT JOIN restaurant_attributes attr
               ON attr.restaurant_id = av.restaurant_id
       RIGHT JOIN items i
               ON attr.restaurant_id = i.restaurant_id
       RIGHT JOIN plus_item_info plus
               ON Cast(i.id AS VARCHAR) = plus.item_id
WHERE  attr.city_id IN ( 3 )
       AND plus.plus_tag = 'plus'; 